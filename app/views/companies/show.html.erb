<% if employee_signed_in? && current_employee.company == @company %>
  <%= render(BoxComponent.new) do |component| %>
    <%= component.title do %>
      Painel colaborador - <%= current_employee.firstname%> (<%=current_employee.role%>)
    <% end %>

    <%= component.body do %>
      <% if current_employee.admin? %>
        <h3>Funcionários cadastrados:</h3>
        <% @company.employees.each do |employee| %>
          <p><%= employee.firstname %> <%= employee.surname %> (<%= employee.role %>)</p>
        <% end %>
        <p><%= link_to 'Editar dados da empresa', edit_company_path(@company) %></p>
      <% end %>
      <p><%= link_to 'Cadastrar nova vaga', new_job_opportunity_path %></p>
    <% end %>
  <% end %>

  <%= render(BoxComponent.new(collapsible: true, default: :closed)) do |component| %>
    <%= component.title { 'Candidaturas recebidas' } %>
    <%= component.body do %>
      <% if @company.job_applications.present? %>
        <% @company.job_applications.each do |a| %>
          <p>
            <%= link_to "#{a.job_opportunity.job_title} - #{a.candidate.firstname} #{a.candidate.surname}", job_application_path(a) %>
            (<%=t("job_applications.status.#{a.status}")%>)
          </p>
        <% end %>
      <% else %>
        <p>Nenhuma candidatura foi recebida ainda.</p>
      <% end %>
    <% end %>
  <% end %>

  <%= render(BoxComponent.new(collapsible: true, default: :closed)) do |component| %>
    <%= component.title { 'Propostas enviadas' } %>
    <%= component.body do %>
      <% if @company.job_proposals.size.positive? %>
        <% @company.job_proposals.each do |a| %>
          <p><%= link_to "#{a.job_application.job_opportunity.job_title} - #{a.job_application.candidate.firstname} #{a.job_application.candidate.surname} [#{a.status}]", job_application_job_proposal_path(a.job_application, a) %></p>
        <% end %>
      <% else %>
        <p>Nenhuma proposta foi enviada.</p>
      <% end %>
    <% end %>
  <% end %>

  <%= render(BoxComponent.new(collapsible: true, default: :closed)) do |component| %>
    <%= component.title { 'Vagas inativas' } %>
    <%= component.body do %>
      <% inactve_job_opportunities = @job_opportunities.inactive %>
      <% if inactve_job_opportunities.present? %>
        <% inactve_job_opportunities.each do |job| %>
          <p><%= link_to "#{job.job_title} (#{job.status})", job_opportunity_path(job) %></p>
        <% end %> 
      <% else %>
        <p>Nenhuma vaga inativa no momento.</p>
      <% end %>
    <% end %>
  <% end %>
<% end %>

<%= render(BoxComponent.new) do |component| %>
  <%= component.title { 'Dados da empresa' } %>
  <%= component.body do %>
    <h3><%= t('.name') %></h3>
    <%= @company.name %> 
    <h3><%= t('.domain') %></h3>
    <%= @company.domain %>
    <h3><%= t('.address') %></h3>
    <%= @company.address %>
    <h3><%= t('.cnpj') %></h3>
    <%= @company.cnpj %>
  <% end %>
<% end %>

<%= render(BoxComponent.new(collapsible: true)) do |component| %>
  <%= component.title { 'Vagas disponíveis' } %>
  <%= component.body do %>
    <% active_job_opportunities = @job_opportunities.active %>
    <% if active_job_opportunities.blank? %>
      <p>Nenhuma vaga ativa no momento.</p>
    <% else %>
      <% active_job_opportunities.each do |job| %>
        <p><%= link_to "#{job.job_title}", job_opportunity_path(job) %> </p>
      <% end %>
    <% end %>
  <% end %>
<% end %>
