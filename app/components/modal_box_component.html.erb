<style>
  .modalbox {
    background: var(--content_blocks_color);
    display: none;
    box-sizing: border-box;
    border-radius: 7px;
    padding: 25px; /* top right bottom left */
    position: fixed;
    left: 50%;
    top: 40px;
    transform: translate(-50%);
    text-align: left;
    max-width: 600px;
  }

  .backdrop {
    background-color: rgba(0,0,0,0.2);
    width: 100vw;
    height: 100vw;
    position: fixed;
    top: 0;
    left: 0;
    opacity: 0;
    display: none;
  }
</style>

<div class="backdrop" id="backdrop<%= @modal_id %>"></div>
  <div  class="modalbox" id="<%= @modal_id %>">
    <div class="title">
      <%= @title %> <button onclick="closeModal(this)" style="float: right;">x</button>
    </div>
    <%= body %>
  </div>

<script>
  var btn = document.getElementById("<%= @show_button_id %>");
  btn.setAttribute('onclick', 'showModal()');

  function showModal() {
    var modal = document.getElementById("<%= @modal_id %>")
    var backdrop = document.getElementById("backdrop<%= @modal_id %>")

    // backdrop.style.display = 'block'
    fadeIn(backdrop)
    modal.style.display = 'block'
  }

  function closeModal(element) {
    var modal = document.getElementById("<%= @modal_id %>")
    var backdrop = document.getElementById("backdrop<%= @modal_id %>")
    // backdrop.style.display = 'none'
    fadeOut(backdrop)
    modal.style.display = 'none'
  }

  function fadeIn(element) {
    var op = 0.1;  // initial opacity
    element.style.display = 'block';
    var timer = setInterval(function () {
        if (op >= 1){
            clearInterval(timer);
        }
        element.style.opacity = op;
        element.style.filter = 'alpha(opacity=' + op * 100 + ")";
        op += op * 0.1;
    }, 10);
  }

  function fadeOut(element) {
    var op = 1;  // initial opacity
    var timer = setInterval(function () {
        if (op <= 0){
          clearInterval(timer);
          element.style.display = 'none';
        }
      element.style.opacity = op;
      element.style.filter = 'alpha(opacity=' + op * 100 + ")";
      op -= 0.1;
    }, 10);
   }
</script>
